# -*- coding: utf-8 -*-
"""Heart_Disease_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1C_i-4XqmDeSugIMA3IdblCFDyGFgkebs

## **HEART DISEASE**

### **Import Library**
"""

import pandas as pd
import numpy as np

from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

"""### **Load Dataset**"""

df = pd.read_csv("Heart_Disease_Prediction.csv")
df.head()

"""### **Cek Structure Data**"""

df.info()

df['Heart Disease'].value_counts()

"""### **Memisahkan Feature dan Target**"""

X = df.drop('Heart Disease', axis=1)
y = df['Heart Disease']

"""### **Encode Target (y)**"""

y = y.map({
    'Absence': 0,
    'Presence': 1
})

y.value_counts()

"""### **Encode Feature (X)**"""

X_encoded = pd.get_dummies(X, drop_first=True)

X_encoded.shape

"""### **Trainâ€“Test Split**"""

X_train, X_test, y_train, y_test = train_test_split(
    X_encoded,
    y,
    test_size=0.2,
    random_state=42,
    stratify=y
)

"""### **Scaling**"""

scaler = StandardScaler()

X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

X_train_scaled[:5]

"""### **Train Logistic Regression**"""

log_reg = LogisticRegression(random_state=42)
log_reg.fit(X_train_scaled, y_train)

"""### **Prediction**"""

y_pred_lr = log_reg.predict(X_test_scaled)

"""### **Evaluation**

##### Accuracy
"""

accuracy = accuracy_score(y_test, y_pred_lr)
accuracy

"""##### Classification Report"""

print(classification_report(y_test, y_pred_lr))

"""##### Confusion Matrix"""

confusion_matrix(y_test, y_pred_lr)

"""### **ROC Curve and AUC**

"""

from sklearn.metrics import roc_curve, roc_auc_score
import matplotlib.pyplot as plt

y_prob_lr = log_reg.predict_proba(X_test_scaled)[:, 1]

fpr, tpr, thresholds = roc_curve(y_test, y_prob_lr)

auc_score = roc_auc_score(y_test, y_prob_lr)
auc_score

plt.figure(figsize=(8,6))
plt.plot(fpr, tpr, label=f'Logistic Regression (AUC = {auc_score:.2f})')
plt.plot([0,1], [0,1], linestyle='--', color='gray')

plt.xlabel('False Positive Rate')
plt.ylabel('True Positive Rate')
plt.title('ROC Curve - Heart Disease Prediction')
plt.legend()
plt.grid(True)
plt.show()

"""#### **Interpretation of ROC Curve and AUC**

The ROC curve shows that the logistic regression model is able to distinguish
between patients with and without heart disease effectively. The AUC value of
approximately 0.87 indicates good classification performance.

This suggests that the model has a strong ability to rank patients with heart
disease higher than those without, making it suitable as a baseline model in
medical risk prediction tasks.

### **Feature Importance Analysis**
"""

import pandas as pd

feature_importance = pd.DataFrame({
    'Feature': X_encoded.columns,
    'Coefficient': log_reg.coef_[0]
})

feature_importance_sorted = feature_importance.reindex(
    feature_importance['Coefficient'].abs().sort_values(ascending=False).index
)

feature_importance_sorted

feature_importance_sorted.head(5)

"""### **Visualisasi Feature Importance**"""

top_features = feature_importance_sorted.head(10)
top_features

import matplotlib.pyplot as plt

plt.figure(figsize=(8, 5))
plt.barh(
    top_features['Feature'],
    top_features['Coefficient']
)
plt.xlabel('Coefficient Value')
plt.title('Top 10 Feature Importance (Logistic Regression)')
plt.gca().invert_yaxis()
plt.show()

"""#### **Interpretation of Feature Importance**

The results show that the number of vessels detected by fluoroscopy is the most
influential feature in predicting heart disease. Positive coefficient values indicate
that higher values of these variables increase the likelihood of heart disease.

Maximum heart rate (Max HR) has a negative coefficient, suggesting that patients with
lower maximum heart rates are more likely to experience heart disease. This finding
is consistent with the exploratory data analysis and the Tableau dashboard results.

Overall, the model aligns well with medical intuition and supports the use of
logistic regression as a strong baseline model for heart disease prediction.

### **Model Evaluation and Interpretation**

The Logistic Regression model achieves an accuracy of approximately 85%, with a good
balance between precision and recall across both classes. This indicates that the model
is capable of distinguishing patients with and without heart disease reasonably well.

However, the confusion matrix shows the presence of some false negatives, which is a
critical consideration in medical applications where failing to detect heart disease
may have serious consequences. Despite this limitation, the model serves as a strong
baseline and provides a solid foundation for further improvement using more advanced
models.

## **Final Conclusion**
This project applied exploratory data analysis and machine learning techniques
to analyze and predict heart disease based on demographic and clinical features.
Using Logistic Regression as a baseline model, the analysis demonstrated that
heart disease can be reasonably predicted using structured clinical data.

The model achieved an accuracy of approximately 85% and an AUC score of around
0.87, indicating good classification performance. Feature importance analysis
revealed that the number of major vessels detected by fluoroscopy, sex, chest
pain type, and maximum heart rate are among the most influential factors in
predicting heart disease.

The negative coefficient of maximum heart rate suggests that patients with lower
exercise capacity are more likely to experience heart disease, aligning with
medical intuition and the results observed during exploratory data analysis.
Overall, this project highlights the importance of combining data exploration,
statistical analysis, and machine learning to gain meaningful insights from
healthcare data.

This work serves as a solid foundation for further model improvement and
comparison using more advanced algorithms.
"""